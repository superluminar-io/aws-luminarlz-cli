customizations:
  cloudFormationStacks:
    # Sets up the AWS Organizations Service Access for Customizations stacks that run in order 2.
    # The template is generated by customizations/lib/organizations-service-access-stack.ts
    - name: LzaCustomization-OrganizationsServiceAccess
      deploymentTargets:
        accounts:
          - Management
      regions:
        - <% homeRegion %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-OrganizationsServiceAccess.template.json"

    # Configures additions to the AWS Landing Zone Accelerator Pipeline,
    # e.g.: s3 trigger, GitHub Actions OIDC and failure notifications.
    # Template is generated by customizations/lib/aws-accelerator-pipeline-stack.ts
    - name: LzaCustomization-AwsAcceleratorPipeline
      deploymentTargets:
        accounts:
          - Management
      regions:
        - <% homeRegion %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-AwsAcceleratorPipeline.template.json"

    # Sets up an hourly Cost and Usage Report that archives all costs in an s3 bucket
    # See: https://docs.aws.amazon.com/cur/latest/userguide/what-is-cur.html
    # The template is generated by customizations/lib/cost-and-usage-report-stack.ts
    - name: LzaCustomization-CostAndUsageReport
      deploymentTargets:
        accounts:
          - Management
      regions:
        - <% globalRegion %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-CostAndUsageReport.template.json"

    # Sets up cost categories which allow categorizing costs in the AWS Cost Explorer
    # The template is generated by customizations/lib/cost-categories-stack.ts
    - name: LzaCustomization-CostCategories
      deploymentTargets:
        accounts:
          - Management
      regions:
        - <% homeRegion %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-CostCategories.template.json"

    # Sets up Alternate Contacts for all accounts in the organization.
    # The template is generated by customizations/lib/alternate-contacts-stack.ts
    - name: LzaCustomization-AlternateContacts
      deploymentTargets:
        accounts:
          - Management
      regions:
        - <% homeRegion %>
      runOrder: 2
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-AlternateContacts.template.json"

{% comment %} TODO: Uncomment this to set up a foundational Security Hub configuration.
    # Enables Security Hub for the Management account.
    # The template is generated by customizations/lib/security-hub-enablement-stack.ts
    - name: LzaCustomization-SecurityHubEnablement
      deploymentTargets:
        accounts:
          - Management
      regions: <% enabledRegions | json %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-SecurityHubEnablement.template.json"

    # Delegates Security Hub to the Audit account.
    # The template is generated by customizations/lib/security-hub-delegated-admin-stack.ts
    - name: LzaCustomization-SecurityHubDelegatedAdmin
      deploymentTargets:
        accounts:
          - Management
      parameters:
        - name: DelegatedAdminAccountId
          value: "{{account Audit}}"
      regions:
        - <% homeRegion %>
      runOrder: 1
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-SecurityHubDelegatedAdmin.template.json"

    # Sets up Security Hub for all member accounts in the organization and all enabled regions.
    # Enables the AWS Foundational Security Best Practices standard.
    # The template is generated by customizations/lib/security-hub-central-configuration-stack.ts
    - name: LzaCustomization-SecurityHubCentralConfiguration
      deploymentTargets:
        accounts:
          - Audit
      regions:
        - <% homeRegion %>
      runOrder: 2
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-SecurityHubCentralConfiguration.template.json"

    # Sets up Security Hub automation rules that, e.g.: allow to automatically suppress irrelevant findings.
    # The template is generated by customizations/lib/security-hub-automation-rules-stack.ts
    - name: LzaCustomization-SecurityHubAutomationRules
      deploymentTargets:
        accounts:
          - Audit
      regions: <% enabledRegions | json %>
      runOrder: 3
      terminationProtection: false
      template: "customizations/cdk.out/LzaCustomization-SecurityHubAutomationRules.template.json"
{% endcomment %}